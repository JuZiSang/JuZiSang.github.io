{"meta":{"title":"橘子的Blog","subtitle":"Blog","description":"记录一些知识","author":"juzisang","url":"https://www.juzisang.com"},"pages":[{"title":"categories","date":"2019-02-10T08:57:05.732Z","updated":"2019-02-10T08:57:05.732Z","comments":true,"path":"categories/index.html","permalink":"https://www.juzisang.com/categories/index.html","excerpt":"","text":""},{"title":"friends","date":"2019-02-10T08:59:09.888Z","updated":"2019-02-10T08:59:09.888Z","comments":true,"path":"friends/index.html","permalink":"https://www.juzisang.com/friends/index.html","excerpt":"","text":""},{"title":"tags","date":"2019-02-10T08:57:05.732Z","updated":"2019-02-10T08:57:05.732Z","comments":true,"path":"tags/index.html","permalink":"https://www.juzisang.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"Centos7下Guacamole安装配置","slug":"Centos7下Guacamole安装配置","date":"2017-09-22T16:00:00.000Z","updated":"2019-01-30T08:17:21.790Z","comments":true,"path":"passages/Centos7下Guacamole安装配置/","link":"","permalink":"https://www.juzisang.com/passages/Centos7下Guacamole安装配置/","excerpt":"介绍 Guacamole 是一个提供远程桌面解决方案的开源项目，通过浏览器就能操作虚拟机，适用于 Chrome、Firefox、IE9+ 等浏览器（浏览器需要支持 HTML5）。只要在一个服务器成功安装 Guancamole，就可以通过访问一个 web 浏览器去操作我们配置好的虚拟机。当然，作为一个开源的项目，我们可以对 Guacamole 做相应的定制修改，使其适配我们的项目需求，比如做成自动登录的，加上项目权限验证等。","text":"介绍 Guacamole 是一个提供远程桌面解决方案的开源项目，通过浏览器就能操作虚拟机，适用于 Chrome、Firefox、IE9+ 等浏览器（浏览器需要支持 HTML5）。只要在一个服务器成功安装 Guancamole，就可以通过访问一个 web 浏览器去操作我们配置好的虚拟机。当然，作为一个开源的项目，我们可以对 Guacamole 做相应的定制修改，使其适配我们的项目需求，比如做成自动登录的，加上项目权限验证等。 准备 Centos7 x86-64 JDK8 Tomcat7 Guacamole 服务器：guacamole-server-0.9.9.tar.gz Guacamole 客户端：guacamole-0.9.9.war JDK 安装 12yum updateyum install java 安装 Tomcat 12345678910111213141516# 创建用户组groupadd tomcatuseradd -s /bin/bash -g tomcat tomcat# 下载Tomcatyum install wgetwget https://archive.apache.org/dist/tomcat/tomcat-8/v8.5.9/bin/apache-tomcat-8.5.9.tar.gztar -zxvf apache-tomcat-8.5.9.tar.gzmv apache-tomcat-8.5.9 tomcatmv ./tomcat /usr/local/# 修改权限chown -R tomcat:tomcat /usr/local/tomcat# 启动/usr/local/tomcat/bin/startup.sh 配置为系统服务 12345678910111213141516171819202122232425262728293031323334# catalina.sh 移动到init.d目录，并重命名tomcatcp /usr/local/tomcat/bin/catalina.sh /etc/init.dmv /etc/init.d/catalina.sh /etc/init.d/tomcat# 修改comcat文件，并将这段的代码加入其中vi /etc/init.d/tomcat#chkconfig:2345 10 90#description:Tomcat service# java和tomcat安装路径CATALINA_HOME=/usr/local/apache-tomcat-8.5.9JAVA_HOME=/usr/local/jdk1.8.0_111# 修改权限chmod +x /etc/init.d/tomcat# 加入服务列表chkconfig --add tomcat# 检查是否加入列表chkconfig --list tomcat# 测试tomcat服务service tomcat# 常用操作service tomcat startservice tomcat stop# 将tomcat加入到环境变量中vi /etc/profile# 末尾加入export CATALINA_HOME=/usr/local/tomcat# 刷新source /etc/profile 安装 Guacamole 服务端 1234567891011121314151617181920212223# 安装依赖yum install -y cairo cairo-devel libpng libpng-devel freerdp freerdp-devel pango pango-devel libssh2 libssh2-devel libtelnet libtelnet-devel libvncserver libvncserver-devel pulseaudio pulseaudio-libs pulseaudio-libs-devel openssl cd openssl-devel libvorbis libvorbis-devel uuid uuid-devel gcc libjpeg-turbo-devel# 编译安装wget http://ncu.dl.sourceforge.net/project/guacamole/current/source/guacamole-server-0.9.9.tar.gztar -xvzf guacamole-server-0.9.9.tar.gzcd guacamole-server-0.9.9/./configure --with-init-dir=/etc/init.dmakemake installldconfig# 配置guacamole服务chown root.root /etc/init.d/guacdchmod 755 /etc/init.d/guacdchkconfig --add guacdchkconfig guacd on# 常用命令service guacd startservice guacd stopservice guacd restartservice guacd status 安装 Guacamole 客户端 配置文件 创建配置文件 12345mkdir /etc/guacamolemkdir /root/.guacamoletouch /etc/guacamole/guacamole.propertiestouch /etc/guacamole/user-mapping.xmlln -s /etc/guacamole/guacamole.properties /root/.guacamole/ guacamole.properties 12# 配置基本用户映射basic-user-mapping: /etc/guacamole/user-mapping.xml user-mapping.xml 12345678910111213141516171819202122232425262728&lt;user-mapping&gt; &lt;authorize username=\"juzisang\" password=\"juzisang\"&gt; &lt;connection name=\"Windows10\"&gt; &lt;protocol&gt;rdp&lt;/protocol&gt; &lt;!-- 加密方式 --&gt; &lt;param name=\"security\"&gt;nla&lt;/param&gt; &lt;param name=\"hostname\"&gt;10.1.48.141&lt;/param&gt; &lt;param name=\"port\"&gt;3389&lt;/param&gt; &lt;!-- 屏幕渲染色值 --&gt; &lt;param name=\"color-depth\"&gt;24&lt;/param&gt; &lt;!-- 用户名密码在nla加密下必须输入 --&gt; &lt;param name=\"username\"&gt;username&lt;/param&gt; &lt;param name=\"password\"&gt;password&lt;/param&gt; &lt;!-- 忽略证书 --&gt; &lt;param name=\"ignore-cert\"&gt;true&lt;/param&gt; &lt;/connection&gt; &lt;connection name=\"Windows10 JuZi\"&gt; &lt;protocol&gt;rdp&lt;/protocol&gt; &lt;param name=\"security\"&gt;nla&lt;/param&gt; &lt;param name=\"hostname\"&gt;192.168.0.125&lt;/param&gt; &lt;param name=\"port\"&gt;3389&lt;/param&gt; &lt;param name=\"color-depth\"&gt;24&lt;/param&gt; &lt;param name=\"username\"&gt;username&lt;/param&gt; &lt;param name=\"password\"&gt;password&lt;/param&gt; &lt;param name=\"ignore-cert\"&gt;true&lt;/param&gt; &lt;/connection&gt; &lt;/authorize&gt;&lt;/user-mapping&gt; 添加进环境变量 12345vi /etc/profile# 末尾添加export GUACAMOLE_HOME=/etc/guacamole# 刷新source /etc/profile 客户端网页下载和安装 12345678wget http://downloads.sourceforge.net/project/guacamole/current/binary/guacamole-0.9.9.war# 移动至 Tomact webapps 目录mv guacamole-0.9.9.war /usr/local/tomcat/webapps/guacamole.war# 重启 Tomcatservice tomcat stopservice tomcat start 遇到问题 编译失败 缺少gcc libjpeg-turbo-devel这两个库，安装即可 1yum install -y gcc libjpeg-turbo-devel RDP 连接 win10 老是断开 guacamole 默认的RDP为标准协议，更改为nla加密协议解决问题， 注意：nla加密下，username，password必须填写 1&lt;param name=\"security\"&gt;nla&lt;/param&gt;","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.juzisang.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.juzisang.com/tags/Linux/"},{"name":"Guacamole","slug":"Guacamole","permalink":"https://www.juzisang.com/tags/Guacamole/"}]},{"title":"群晖使用Frp实现内网穿透","slug":"群晖使用Frp实现内网穿透","date":"2017-08-19T16:00:00.000Z","updated":"2019-01-30T08:17:21.790Z","comments":true,"path":"passages/群晖使用Frp实现内网穿透/","link":"","permalink":"https://www.juzisang.com/passages/群晖使用Frp实现内网穿透/","excerpt":"准备 群晖 拥有外网ip的vps frp 域名（不是必须，你也可以用ip来访问）","text":"准备 群晖 拥有外网ip的vps frp 域名（不是必须，你也可以用ip来访问） VPS设置 下载Frp 我这是使用的是64位的 ubuntu 系统的，如果需要其他的，请自行在 Github 上下载对应的版本 12345678// 下载wget https://github.com/fatedier/frp/releases/download/v0.13.0/frp_0.13.0_linux_amd64.tar.gz// 解压tar -zxvf frp_0.13.0_linux_amd64.tar.gz// 进去frp目录cd frp_0.13.0_linux_amd64// 删除不需要的文件rm -rf frpc frpc.ini frpc_full.ini Frps配置 1234567891011121314151617181920212223242526272829303132[common]bind_port = 7000max_pool_count = 5authentication_timeout = 900# 管理端 进入frp自带的web管理界面的帐号密码dashboard_port = 7500dashboard_user = userdashboard_pwd = pwd# ssh端口 auth_token就是密钥，随便填个[ssh]listen_port = 6000auth_token = token# 群晖网页[dms]listen_port = 5000auth_token = token# 群晖[cloud_station]listen_port = 6690auth_token = token[ds_photo]listen_port = 8080auth_token = token# 域名# vhost_http_port = 80# subdomain_host = juzisang.com 启动 1./frps -c ./frps.ini 群晖配置 开启ssh ssh进入群晖 1234// ssh进入群晖ssh juzisang@群晖局域网ip// 切换root用户sudo -s 下载Frp 12345678// 下载wget https://github.com/fatedier/frp/releases/download/v0.13.0/frp_0.13.0_linux_amd64.tar.gz// 解压tar -zxvf frp_0.13.0_linux_amd64.tar.gz// 进去frp目录cd frp_0.13.0_linux_amd64// 删除不需要的文件rm -rf frps frps.ini frps_full.ini Frpc配置 1234567891011121314151617181920212223242526272829303132333435363738[common]server_addr = xx.xx.xx.xxserver_port = 7000// frps中填的auth_token = tokenpool_count = 1# ssh[ssh]type = tcp// 群晖局域网iplocal_ip = 192.168.31.50// 本地端口local_port = 22// 穿透到vps中的端口remote_port = 6000# 群晖网页[dms]type = tcplocal_ip = 192.168.31.50local_port = 5000remote_port = 5000# subdomain = nas# 群晖同步[cloud_station]type = tcplocal_ip = 192.168.31.50local_port = 6690remote_port = 6690# 群晖照片[ds_photo]type = tcplocal_ip = 192.168.31.50local_port = 80remote_port = 8080 启动 1./frps -c ./frps.ini 后台运行 服务端 1nohup ./frps -c ./frps.ini &amp; 客户端 1nohup ./frpc -c ./frpc.ini &amp;","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.juzisang.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.juzisang.com/tags/Linux/"},{"name":"Frp","slug":"Frp","permalink":"https://www.juzisang.com/tags/Frp/"},{"name":"群晖","slug":"群晖","permalink":"https://www.juzisang.com/tags/群晖/"}]}]}